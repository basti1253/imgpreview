(function(a){a.ajaxPrefilter("img",function(a){a.cache==null&&(a.cache=!1),a.type="GET",a.async=!0}),a.ajaxTransport("img",function(a){var b;return{send:function(c,d){var e=new Image;b=function(a){var c=e;b=e=e.onload=e.onerror=null,a!=null&&(a?d(200,"OK",{img:c}):d(404,"Not Found"))},e=new Image,e.onload=function(){b(!0)},e.onerror=function(){b(!1)},e.src=a.url},abort:function(){b&&b()}}})})(jQuery),function(a){a.widget("dyn.imgpreview",{options:{offset:{x:100,y:-100},loader:{uiClass:"ui-dialog",cssClass:"dyn-imgpreview-preloader",loadingText:"Bitte warten - Bild wird geladen"}},_create:function(){this._addContainer(),this._hoverable(),this._focusable(),this._bind({focus:"_open",mouseenter:"_open",blur:"_close",mouseleave:"_close",mousemove:"_mouseMove"})},_open:function(b){if(!this.options.disabled){var c=this,d=this._getDescription();this.container.removeClass("ui-helper-hidden").find("p").show(),a.ajax({url:this.element.data("img"),cache:!0,dataType:"img"}).success(function(a){c.container.find("p").hide(),c.imageContainer.removeClass(c.options.loader.cssClass+"-loading").html(a).append("<p>"+d+"</p>")}).error(function(){c.container.addClass("ui-helper-hidden")}),this._trigger("open",b,this._ui())}},_close:function(a){var b=this;this.imageContainer.html("").addClass(b.options.loader.cssClass+"-loading"),this.container.addClass("ui-helper-hidden").find("p").show(),this._trigger("close",a,this._ui())},_mouseMove:function(a){var b=this.options,c=a.pageX+b.offset.x,d=a.pageY+b.offset.y;this.container.css("top",d+"px").css("left",c+"px")},_addContainer:function(){var b=this.options,c=b.loader,d=a("."+c.cssClass),e=a("body");if(!(e.length<1)){if(d.length>0){this.container=d.parent(),this.imageContainer=d;return}d=a(["<div class='"+c.uiClass+" ui-state-focus'>",'<div class="'+c.cssClass+" "+c.cssClass+'-loading"></div>',"<p>"+c.loadingText+"</p>","</div>"].join("")).addClass("ui-helper-hidden"),this.container=d,this.imageContainer=d.find("."+c.cssClass),e.append(d)}},_remove:function(){this.container.remove()},_getDescription:function(){var a=this.element.data("desc");return a&&a.length>0?a:""},_ui:function(){return{container:this.container,imageContainer:this.imageContainer,image:this.element.data("img"),description:this._getDescription()}},destroy:function(){this._remove(),this._superApply("destroy",arguments)}})}(jQuery)